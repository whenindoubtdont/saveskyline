# Save Skyline Wilderness Park

A static advocacy website urging Napa County residents to oppose the planned 185-unit housing development on 5 acres of Skyline Wilderness Park. The site provides facts, sources, a pre-written email template, media contact list, supervisor phone numbers, and a "Find Your Supervisor" address lookup — everything a concerned resident needs to take action in under 5 minutes.

**Live site:** [whenindoubtdont.github.io/saveskyline](https://whenindoubtdont.github.io/saveskyline/)

---

## What This Site Does

The site is a single-page advocacy tool designed to convert visitors into callers and emailers. It walks them through:

1. **The Threat** — What's happening: the state designated 20 acres of Skyline Park as "surplus" under Executive Order N-06-19, and the first 5-acre slice is slated for 185 high-density housing units by PEP Housing / Collective Operations LLC. Construction could start late 2027.

2. **Our Park** — What's at stake: 874 acres of public open space used for archery ranges (Silverado Archers, est. 1954), Suscol Intertribal Council pow wows, Boy Scout camping, equestrian shows, BottleRock overflow parking, wildfire crew base camps, and more. The county bought the park for $7.26M in December 2024 to protect it.

3. **Silverado Archers** — The archery club that catalyzed this campaign. Their president Matt Petrini's original email to members is reproduced verbatim on the site.

4. **Take Action** — The core of the site:
   - A **pre-written email template** visitors can copy with one click or open directly in Gmail, Yahoo, Outlook, or their default mail app.
   - A **media contact grid** with 10 newsrooms (Napa Valley Register, KQED, KPIX, KGO, KRON, KCRA, Fox, California Globe, News Netter) — each with a one-click email copy button.
   - **"Who's My Supervisor?"** — An address lookup that geocodes a Napa address and queries Napa County's official ArcGIS FeatureServer to identify the visitor's supervisor district, name, and direct phone number with a tap-to-call button.
   - **Share / Forward** buttons using the Web Share API (with clipboard fallback), plus a "Forward to a Neighbor" mailto link.
   - Direct **phone numbers** for all 5 supervisors and the Clerk of the Board.

5. **Sources** — 12 linked, cited sources backing every claim on the page: Napa Valley Register articles, CA Dept. of General Services project page, Sierra Club opposition letters, KQED coverage, the Governor's Executive Order, and official park/club websites.

6. **Podcast** — An AI-generated audio overview with a sticky player, play/pause, seek, download, and a disclaimer that it's AI-generated.

---

## How Content Works

**All text on the site is driven by `content.json`.** The HTML contains fallback text that's visible immediately, then `script.js` loads `content.json` on page load and applies values to any element with a `data-content` attribute.

### Editing Content

To change any text on the site:

1. Open `content.json` in any text editor.
2. Find the key you want to change. Keys are organized by section: `hero.headline`, `threat.paragraph1`, `action.emailTemplate`, etc.
3. Save the file and refresh the page.

The `_editorNote` at the top of `content.json` explains the conventions. Use `\n` for line breaks in long strings (like the email template). Use `**bold text**` for bold formatting in paragraphs that support it.

### Updating Supervisor Names

After elections, supervisor names will change. Update them in **two places**:

1. **`content.json`** — The `supervisors` array (used by the district finder JS).
2. **`index.html`** — The supervisor grid in the `#action` section (the `#supervisor-list` div), which contains hardcoded names and phone numbers as HTML fallback.
3. **`script.js`** — The `supervisors` object inside `initDistrictFinder()`.

The phone numbers for each district office rarely change between supervisors, but verify them at [napacounty.gov](https://www.napacounty.gov/1316/Board-of-Supervisors).

### Updating Media Contacts

Edit the `contacts` array in `content.json`. Each entry has a `name` and `email`. These are rendered by `populateContacts()` in `script.js`.

### Updating Sources

Edit the `sources` array in `content.json`. Each entry has `name`, `url`, and `description`. They render as clickable cards in the Sources section.

---

## File Inventory

| File | Purpose | Size |
|------|---------|------|
| `index.html` | The entire page — all sections, nav, hero, action, footer, audio player | 35 KB |
| `content.json` | All editable text, contacts, sources, supervisor data | 14 KB |
| `script.js` | Source JavaScript — content loader, contacts, district finder, audio, share, copy, mobile menu, scroll effects | 21 KB |
| `script.min.js` | Minified JS served in production (generated by terser) | 14 KB |
| `style.css` | Source CSS — hero, skip link, section reveals, mobile menu, back-to-top, scrollbar | 3.2 KB |
| `style.min.css` | Minified CSS served in production (generated by clean-css) | 2.3 KB |
| `skylinehillsky.jpeg` | Hero background image (1920x1440, quality 68) | 281 KB |
| `skylinearcheryrange.jpeg` | Archers section photo (1200x900, quality 65) | 175 KB |
| `infographic.png` | Below-fold infographic (1400px wide, optipng optimized) | 1.6 MB |
| `skyline-park-podcast.m4a` | AI-generated audio overview | 23 MB |
| `.gitignore` | Excludes Lighthouse reports, node_modules, .DS_Store, backup originals | — |

---

## Hosting

The site is hosted on **GitHub Pages** from the repo's root. There is no build step required for deployment — push to `main` and GitHub Pages serves it.

- **Canonical URL:** `https://whenindoubtdont.github.io/saveskyline/`
- OG/Twitter meta tags, canonical link, and share URLs all reference this URL.
- The `skyline-park-podcast.m4a` file is 23 MB. GitHub Pages has a 100 MB per-file limit, so it's fine, but be aware of the repo size if adding more large media.

---

## External Services (No API Keys Required)

The site uses two free, public APIs for the "Find Your Supervisor" feature. Neither requires authentication or API keys.

### ArcGIS World Geocoder
- **What:** Converts a street address into latitude/longitude coordinates.
- **Endpoint:** `https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates`
- **CORS:** Allowed from GitHub Pages origin.
- **Cost:** Free for basic geocoding without an API key.
- **Used by:** `initDistrictFinder()` in `script.js`.

### Napa County Supervisor Districts FeatureServer
- **What:** Given a lat/lng point, returns which supervisor district contains it, plus the supervisor name.
- **Endpoint:** `https://gis.napacounty.gov/arcgis/rest/services/Hosted/Supervisor_Districts/FeatureServer/0/query`
- **CORS:** Allowed from GitHub Pages origin.
- **Note:** The GIS layer's `supervisor` field contains stale names (e.g. "Brad Wagenknecht" for District 1). The code ignores the API-returned name and maps the district number to the correct current supervisor from a local lookup table. This is intentional.
- **Used by:** `initDistrictFinder()` in `script.js`.

### Napa County Official Lookup (Linked as Fallback)
- **URL:** `https://www.countyofnapa.org/2051/Find-My-Supervisor-and-District`
- Linked at the bottom of the supervisor card for users who prefer the official tool.

---

## For Developers

### Tech Stack

- **HTML/CSS/JS** — No framework, no build system, no dependencies to install.
- **Tailwind CSS** via the [Play CDN](https://cdn.tailwindcss.com) (`<script>` tag). This is ~500 KB of JS loaded on every page. It's not ideal for production, but it works without a build step. Migrating to the Tailwind CLI would be the single biggest performance win (see Future Work).
- **Font Awesome 6.5.1** via cdnjs CDN.
- **Google Fonts** — Outfit (weights 400, 600, 700, 800) for headings.
- **Custom CSS** in `style.css` — hero parallax, section reveal animations, mobile menu, skip link, back-to-top, iOS Safari fixes.

### Local Development

```bash
cd /path/to/saveskyline
python3 -m http.server 8765
# Open http://localhost:8765
```

Any static file server works. The site has no server-side requirements.

### Rebuilding Minified Files

After editing `style.css` or `script.js`, rebuild the minified production files:

```bash
npx clean-css-cli style.css -o style.min.css
npx terser script.js -o script.min.js -c -m
```

The HTML references `style.min.css` and `script.min.js`. If you forget to rebuild, the site still works — it just serves the old minified versions. The source files (`style.css`, `script.js`) are not loaded in production.

### Architecture Notes

**Content system:** `script.js` fetches `content.json` on load. The `applyContent()` function walks every `[data-content]` element and sets its text (or HTML for specific paths like `threat.heading` which uses `<br>`, or `threat.paragraph1` which uses `**bold**` via markdown-like parsing). If `content.json` fails to load, the HTML fallback text remains visible and a hardcoded contact list is used.

**Section reveals:** Sections with class `section-reveal` start at `opacity: 0; transform: translateY(20px)` and get `.is-visible` added via `IntersectionObserver` when they scroll into view. Respects `prefers-reduced-motion`.

**Hero parallax:** Uses `background-attachment: fixed` with a `@supports (-webkit-touch-callout: none)` fallback to `scroll` for iOS Safari, where fixed attachment is broken.

**District finder:** Not a `<form>` (intentional — forms cause native page reloads if JS hasn't loaded). It's a `<div role="search">` with a click handler on the button and a keydown handler for Enter on the input.

**Audio player:** The podcast uses `preload="none"` so the 23 MB file isn't fetched until the user clicks "Listen while you read." The sticky player slides up from the bottom with play/pause, seek (click the progress bar), download, and close.

**Share:** Uses the Web Share API where available (mobile browsers). Falls back to `navigator.clipboard.writeText()`. All clipboard calls have `.catch()` handlers so failures don't silently break.

### Lighthouse Scores (Local, as of Feb 17, 2026)

| Category | Score |
|----------|-------|
| Performance | 90 |
| Accessibility | 86 |
| Best Practices | 96 |
| SEO | 100 |

The main performance bottleneck is the Tailwind Play CDN (~500 KB JS). Migrating to a built CSS file would likely push Performance to 95+. The Accessibility gap is primarily contrast ratios on some stone-colored text; tightening those would close the gap.

### Future Work / Known Issues

1. **Tailwind CLI migration** — Replace `<script src="https://cdn.tailwindcss.com">` with a pre-built CSS file. This eliminates the ~500 KB JS payload and is the single biggest performance win available. Requires adding a build step (`npx tailwindcss -i style.css -o dist.css --minify`).

2. **Accessibility contrast** — Some `text-stone-400` and `text-stone-500` text on `bg-stone-900`/`bg-stone-950` backgrounds doesn't meet WCAG AA contrast ratios. Bumping to `text-stone-300` where needed would fix this.

3. **Supervisor name staleness** — The Napa County GIS layer returns outdated supervisor names. The code works around this with a local lookup table, but it means names must be manually updated after elections in three places (see "Updating Supervisor Names" above).

4. **Large media files** — The podcast (23 MB) and infographic (1.6 MB) make the repo heavy. If repo size becomes an issue, consider hosting media on a CDN or using Git LFS.

5. **Test on real devices** — The site has been developed and audited in headless Chrome. Before any major content update, test on:
   - Safari on iPhone (hero parallax fallback, audio player, share API)
   - Safari on iPad
   - Chrome on Android
   - Desktop Safari, Chrome, Firefox

---

## License

This site was built by Napa County residents to protect public parkland. It is not affiliated with any government agency, political campaign, or developer. Use it, share it, fork it.
